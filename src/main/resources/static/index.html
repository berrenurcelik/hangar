<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hangar Management System</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="container">
      <header class="app-header">
        <h1>✈️ Hangar Management System</h1>
        <div id="auth-header" class="auth-header"></div>
      </header>

      <!-- Dashboard abhängig von Rolle / Login -->
      <div id="user-dashboard" class="content" style="display: none;">
        <h2 id="dashboard-title">Willkommen im Hangar Management System</h2>
        <p id="dashboard-subtitle" style="margin-top: 10px; margin-bottom: 20px;">
          Nutzen Sie die wichtigsten Funktionen über die Kacheln unten – z.&nbsp;B.
          <strong>Profil</strong>, <strong>Flugzeugdaten</strong>, <strong>Stellplatzsuche</strong>,
          <strong>Wartungsdaten</strong> oder <strong>Termine</strong>.
        </p>

        <!-- Nur Flugzeugbesitzer -->
        <div id="dashboard-owner" class="dashboard-grid" style="display: none;">
          <div class="dashboard-card">
            <h3>Meine Flugzeuge</h3>
            <p>Flugzeugdaten anlegen und aktualisieren.</p>
            <a href="meine-flugzeuge.html" class="btn-primary">Flugzeugdaten öffnen</a>
          </div>
          <div class="dashboard-card">
            <h3>Stellplatz &amp; Angebote</h3>
            <p>Stellplätze suchen, Standortdetails einsehen und Angebote verwalten.</p>
            <a href="parking-search.html" class="btn-secondary">Stellplatz suchen</a>
            <br/><br/>
            <a href="meine-angebote.html" class="btn-secondary">Meine Angebote</a>
          </div>
          <div class="dashboard-card">
            <h3>Ersatzteile &amp; Reservierungen</h3>
            <p>Ersatzteile suchen und Reservierungen anlegen.</p>
            <a href="ersatzteile.html" class="btn-primary">Ersatzteile anzeigen</a>
          </div>
          <div class="dashboard-card">
            <h3>Termine &amp; Zusatzservices</h3>
            <p>Übergabe-/Rückgabetermine und Zusatzservice-Buchungen im Blick behalten.</p>
            <a href="uebergabe-termine.html" class="btn-secondary">Termine verwalten</a>
            <br/><br/>
            <a href="zusatzservices.html" class="btn-secondary">Zusatzservices buchen</a>
          </div>
        </div>

        <!-- Nur Hangaranbieter -->
        <div id="dashboard-hp" class="dashboard-grid" style="display: none;">
          <div class="dashboard-card">
            <h3>Stellplätze</h3>
            <p>Stellplatzkapazitäten und Status pflegen.</p>
            <a href="stellplaetze.html" class="btn-primary">Stellplätze öffnen</a>
          </div>
          <div class="dashboard-card">
            <h3>Flugzeuge im Hangar</h3>
            <p>Wartungs- und Flugbereitschaftsdaten verwalten.</p>
            <a href="flugzeuge-im-hangar.html" class="btn-secondary">Flugzeuge anzeigen</a>
          </div>
          <div class="dashboard-card">
            <h3>Wartungsanfragen</h3>
            <p>Reparatur- / Wartungsanfragen an Werkstätten stellen.</p>
            <a href="reparatur-wartungsanfrage.html" class="btn-primary">Anfrage erstellen</a>
          </div>
          <div class="dashboard-card">
            <h3>Wartungstermine</h3>
            <p>Bestätigte Anfragen in Termine überführen.</p>
            <a href="wartungstermine.html" class="btn-secondary">Termine planen</a>
          </div>
          <div class="dashboard-card">
            <h3>Terminanfragen</h3>
            <p>Übergabe- und Rückgabeterminanfragen der Flugzeugbesitzer bearbeiten.</p>
            <a href="terminanfragen.html" class="btn-secondary">Terminanfragen öffnen</a>
          </div>
        </div>

        <!-- Gast (nicht eingeloggt) – beide Rollen kurz vorstellen -->
        <div id="dashboard-guest" class="dashboard-grid" style="display: none;">
          <div class="dashboard-card">
            <h3>Für Flugzeugbesitzer</h3>
            <ul>
              <li>Flugzeuge und Wartungsstatus verwalten</li>
              <li>Stellplätze suchen und Angebote annehmen</li>
              <li>Ersatzteile und Zusatzservices buchen</li>
            </ul>
          </div>
          <div class="dashboard-card">
            <h3>Für Hangaranbieter</h3>
            <ul>
              <li>Stellplätze und Einlagerungsservices anbieten</li>
              <li>Wartungs- &amp; Flugbereitschaftsdaten pflegen</li>
              <li>Reparatur- / Wartungsanfragen und Termine verwalten</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Admin-Dashboard (nur sichtbar, wenn kein Benutzer eingeloggt ist, z.B. für Tests/Administration) -->
      <div id="admin-dashboard">
      <div class="tabs">
        <button class="tab active" onclick="showTab('aircraft-owners')">
          Aircraft Owners
        </button>
        <button class="tab" onclick="showTab('hangar-providers')">
          Hangar Providers
        </button>
        <button class="tab" onclick="showTab('aircrafts')">Aircrafts</button>
        <button class="tab" onclick="showTab('appointments')">
          Appointments
        </button>
        <button class="tab" onclick="showTab('parking')">Parking</button>
        <button class="tab" onclick="showTab('spare-parts')">
          Spare Parts
        </button>
        <button class="tab" onclick="showTab('services')">Services</button>
        <button class="tab" onclick="showTab('reservations')">
          Article Reservations
        </button>
      </div>

      <div class="content">
        <!-- Aircraft Owners Tab -->
        <div id="aircraft-owners" class="tab-content">
          <h2>Aircraft Owner Management</h2>
          <div id="owner-alert"></div>

          <form id="ownerForm" onsubmit="createAircraftOwner(event)">
            <div class="form-group">
              <label>Name *</label>
              <input type="text" id="ownerName" required />
            </div>
            <div class="form-group">
              <label>Email *</label>
              <input type="email" id="ownerEmail" required />
            </div>
            <div class="form-group">
              <label>Password *</label>
              <input type="password" id="ownerPassword" required />
            </div>
            <div class="form-group">
              <label>Contact</label>
              <input type="text" id="ownerContact" />
            </div>
            <button type="submit">Add Aircraft Owner</button>
          </form>

          <h3 style="margin-top: 30px">Aircraft Owners List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Contact</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="ownersTableBody"></tbody>
          </table>
        </div>

        <!-- Hangar Providers Tab -->
        <div id="hangar-providers" class="tab-content hidden">
          <h2>Hangar Provider Management</h2>
          <div id="provider-alert"></div>

          <form id="providerForm" onsubmit="createHangarProvider(event)">
            <div class="form-group">
              <label>Name *</label>
              <input type="text" id="providerName" required />
            </div>
            <div class="form-group">
              <label>Email *</label>
              <input type="email" id="providerEmail" required />
            </div>
            <div class="form-group">
              <label>Password *</label>
              <input type="password" id="providerPassword" required />
            </div>
            <div class="form-group">
              <label>Contact</label>
              <input type="text" id="providerContact" />
            </div>
            <div class="form-group">
              <label>Service Hours</label>
              <input
                type="text"
                id="providerServiceHours"
                placeholder="e.g., Mon-Fri 8:00-18:00"
              />
            </div>
            <button type="submit">Add Hangar Provider</button>
          </form>

          <h3 style="margin-top: 30px">Hangar Providers List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Contact</th>
                <th>Service Hours</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="providersTableBody"></tbody>
          </table>
        </div>

        <!-- Aircrafts Tab -->
        <div id="aircrafts" class="tab-content hidden">
          <h2>Aircraft Management</h2>
          <div id="aircraft-alert"></div>

          <form id="aircraftForm" onsubmit="createAircraft(event)">
            <div class="form-group">
              <label>Registration Mark *</label>
              <input type="text" id="aircraftRegistrationMark" required />
            </div>
            <div class="form-group">
              <label>Size</label>
              <input type="number" id="aircraftSize" />
            </div>
            <div class="form-group">
              <label>Dimensions</label>
              <input
                type="text"
                id="aircraftDimensions"
                placeholder="e.g., 10m x 15m"
              />
            </div>
            <div class="form-group">
              <label>Maintenance Status</label>
              <input type="text" id="aircraftMaintenanceStatus" />
            </div>
            <div class="form-group">
              <label>Flight Readiness</label>
              <input type="text" id="aircraftFlightReadiness" />
            </div>
            <button type="submit">Add Aircraft</button>
          </form>

          <h3 style="margin-top: 30px">Aircrafts List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Registration Mark</th>
                <th>Size</th>
                <th>Dimensions</th>
                <th>Maintenance Status</th>
                <th>Flight Readiness</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="aircraftsTableBody"></tbody>
          </table>
        </div>

        <!-- Appointments Tab -->
        <div id="appointments" class="tab-content hidden">
          <h2>Appointment Management</h2>
          <div id="appointment-alert"></div>

          <form id="appointmentForm" onsubmit="createAppointment(event)">
            <div class="form-group">
              <label>Hangar Provider ID *</label>
              <input type="number" id="apptHangarProviderId" required />
            </div>
            <div class="form-group">
              <label>Date *</label>
              <input type="date" id="apptDate" required />
            </div>
            <div class="form-group">
              <label>Time *</label>
              <input type="time" id="apptTime" required />
            </div>
            <div class="form-group">
              <label>Type *</label>
              <select id="apptType" required>
                <option value="PARKING">Parking</option>
                <option value="MAINTENANCE">Maintenance</option>
                <option value="INSPECTION">Inspection</option>
                <option value="REPAIR">Repair</option>
              </select>
            </div>
            <button type="submit">Create Appointment</button>
          </form>

          <h3 style="margin-top: 30px">Appointments List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Time</th>
                <th>Type</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="appointmentsTableBody"></tbody>
          </table>
        </div>

        <!-- Parking Tab -->
        <div id="parking" class="tab-content hidden">
          <h2>Parking Management</h2>
          <div id="parking-alert"></div>

          <form id="parkingForm" onsubmit="createParking(event)">
            <div class="form-group">
              <label>Parking Number *</label>
              <input type="number" id="parkingNumber" required />
            </div>
            <div class="form-group">
              <label>Status *</label>
              <select id="parkingStatus" required>
                <option value="AVAILABLE">Available</option>
                <option value="OCCUPIED">Occupied</option>
                <option value="RESERVED">Reserved</option>
                <option value="MAINTENANCE">Maintenance</option>
              </select>
            </div>
            <div class="form-group">
              <label>Site Status</label>
              <input
                type="text"
                id="parkingSiteStatus"
                placeholder="e.g., Good condition"
              />
            </div>
            <button type="submit">Add Parking Spot</button>
          </form>

          <h3 style="margin-top: 30px">Parking Spots List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Number</th>
                <th>Status</th>
                <th>Site Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="parkingTableBody"></tbody>
          </table>
        </div>

        <!-- Spare Parts Tab -->
        <div id="spare-parts" class="tab-content hidden">
          <h2>Spare Parts Management</h2>
          <div id="parts-alert"></div>

          <div class="form-group">
            <label>Search Parts</label>
            <input
              type="text"
              id="partsSearch"
              placeholder="Search by name or description..."
              onkeyup="searchSpareParts()"
            />
          </div>

          <h3 style="margin-top: 30px">Spare Parts List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Description</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Available</th>
              </tr>
            </thead>
            <tbody id="partsTableBody"></tbody>
          </table>
        </div>

        <!-- Services Tab -->
        <div id="services" class="tab-content hidden">
          <h2>Services Management</h2>
          <div id="service-alert"></div>

          <form id="serviceForm" onsubmit="createService(event)">
            <div class="form-group">
              <label>Service Name *</label>
              <input type="text" id="serviceName" required />
            </div>
            <div class="form-group">
              <label>Description</label>
              <textarea id="serviceDescription" rows="3"></textarea>
            </div>
            <div class="form-group">
              <label>Price *</label>
              <input type="number" id="servicePrice" required />
            </div>
            <button type="submit">Add Service</button>
          </form>

          <h3 style="margin-top: 30px">Services List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Description</th>
                <th>Price</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="servicesTableBody"></tbody>
          </table>
        </div>

        <!-- Article Reservations Tab - UC FB.10 -->
        <div id="reservations" class="tab-content hidden">
          <h2>Article Reservations</h2>
          <div id="reservation-alert"></div>

          <form id="reservationForm" onsubmit="createReservation(event)">
            <div class="form-row">
              <div class="form-group">
                <label>Aircraft Owner ID *</label>
                <input type="number" id="resAcoId" required />
              </div>
              <div class="form-group">
                <label>Parts Provider ID *</label>
                <input type="number" id="resPsId" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Spare Part ID *</label>
                <input type="number" id="resSparePartId" required />
              </div>
              <div class="form-group">
                <label>Quantity *</label>
                <input type="number" id="resQuantity" min="1" required />
              </div>
            </div>
            <div class="form-group">
              <label>Status *</label>
              <select id="resStatus" required>
                <option value="PENDING">Pending</option>
                <option value="CONFIRMED">Confirmed</option>
                <option value="DELIVERED">Delivered</option>
                <option value="CANCELLED">Cancelled</option>
              </select>
            </div>
            <button type="submit">Create Reservation</button>
          </form>

          <h3 style="margin-top: 30px">Reservations List</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Spare Part ID</th>
                <th>ACO ID</th>
                <th>PS ID</th>
                <th>Quantity</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="reservationsTableBody"></tbody>
          </table>
        </div>
      </div>
      </div> <!-- /admin-dashboard -->
    </div>

    <div class="bottom-nav" id="bottom-nav">
      <a href="index.html" class="bottom-nav__item bottom-nav__item--active" id="bottom-home">Home</a>
      <a href="profile.html" class="bottom-nav__item" id="bottom-profile">Profil</a>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script>
      (function () {
        var user = getCurrentUser();
        var el = document.getElementById('auth-header');
        var adminDashboard = document.getElementById('admin-dashboard');
        var userDashboard = document.getElementById('user-dashboard');
        var dashOwner = document.getElementById('dashboard-owner');
        var dashHp = document.getElementById('dashboard-hp');
        var dashGuest = document.getElementById('dashboard-guest');
        var dashTitle = document.getElementById('dashboard-title');
        var dashSubtitle = document.getElementById('dashboard-subtitle');
        var bottomProfile = document.getElementById('bottom-profile');

        if (!el) return;
        if (user && user.name) {
          var roleLabel = user.role === 'AIRCRAFT_OWNER'
            ? 'Flugzeugbesitzer'
            : user.role === 'HANGAR_PROVIDER'
              ? 'Hangaranbieter'
              : user.role || '';
          el.innerHTML =
            '<span class="auth-user">Hallo, ' +
            (user.name || user.email) +
            ' <span class="auth-role">(' +
            roleLabel +
            ')</span></span> ' +
            '<a href="#" onclick="logout(); return false;" class="auth-link">Abmelden</a>';

          // Für normale Benutzer:  Dashboard, Admin-Tab-UI ausblenden
          if (adminDashboard) adminDashboard.style.display = 'none';
          if (userDashboard) userDashboard.style.display = 'block';

          if (dashGuest) dashGuest.style.display = 'none';
          if (user.role === 'AIRCRAFT_OWNER') {
            if (dashOwner) dashOwner.style.display = 'grid';
            if (dashHp) dashHp.style.display = 'none';
            if (dashTitle) dashTitle.textContent = 'Willkommen im Hangar Management System';
            if (dashSubtitle) dashSubtitle.textContent = 'Wählen Sie eine Funktion aus, um Ihre Flugzeug- und Buchungsdaten zu verwalten.';
            if (bottomProfile) bottomProfile.href = 'profile.html';
          } else if (user.role === 'HANGAR_PROVIDER') {
          if (dashOwner) dashOwner.style.display = 'none';
          if (dashHp) dashHp.style.display = 'grid';
          if (dashTitle) dashTitle.textContent = 'Willkommen im Hangar Management System';
          if (dashSubtitle) dashSubtitle.textContent = 'Wählen Sie eine Funktion aus, um Stellplätze, Wartungsdaten und Termine zu verwalten.';
          if (bottomProfile) bottomProfile.href = 'hp-profile.html';
          }
        } else {
          // Kein Login: Begrüßungs-Dashboard mit beiden Rollen anzeigen
          el.innerHTML =
            '<a href="login.html" class="auth-link">Anmelden</a> &nbsp;|&nbsp; <a href="register.html" class="auth-link">Registrieren</a>';
          if (adminDashboard) adminDashboard.style.display = 'none';
          if (userDashboard) userDashboard.style.display = 'block';
          if (dashOwner) dashOwner.style.display = 'none';
          if (dashHp) dashHp.style.display = 'none';
          if (dashGuest) dashGuest.style.display = 'grid';
          if (dashTitle) dashTitle.textContent = 'Willkommen im Hangar Management System';
          if (dashSubtitle) dashSubtitle.textContent = 'Melden Sie sich an, um Stellplätze, Flugzeuge und Wartungsdaten zu verwalten.';
          if (bottomProfile) bottomProfile.href = 'login.html';
        }
      })();
    </script>
  </body>
</html>
